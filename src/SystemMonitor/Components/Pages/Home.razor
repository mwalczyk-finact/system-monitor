@page "/"
@using ApexCharts
@using SystemMonitor.Services
@using SystemMonitor.Components.Buttons
@using SystemMonitor.Components.Typo
@using SystemMonitor.Models
@using SystemMonitor.Components.Charts

@inject ISystemPerformanceService PerformanceService

<MudContainer Class="mb-4" Style="text-align: center; margin-top: 20px; overflow: visible;">
    <MudText Color="MudBlazor.Color.Primary" Typo="Typo.h3" Style="font-weight:bold; margin-bottom: 16px;">
        System Performance Monitor
    </MudText>

    <MudSelect T="int" Label="Update Frequency (seconds)" Value="@updateInterval" ValueChanged="OnUpdateIntervalChanged">
        <MudSelectItem Value="1">1 second</MudSelectItem>
        <MudSelectItem Value="5">5 seconds</MudSelectItem>
        <MudSelectItem Value="10">10 seconds</MudSelectItem>
    </MudSelect>

    <RoundedButton Color="MudBlazor.Color.Success" Icon="@Icons.Material.Filled.PlayCircle" OnClick="@StartMonitoring" Text="Start">  </RoundedButton>
    <RoundedButton Color="MudBlazor.Color.Warning" Icon="@Icons.Material.Filled.PauseCircle" OnClick="@PauseMonitoring" Text="Pause">  </RoundedButton>
    <RoundedButton Color="MudBlazor.Color.Error" Icon="@Icons.Material.Filled.RestartAlt" OnClick="@ResetCharts" Text="Reset">  </RoundedButton>

    <AverageUsageDisplay Label="Average CPU Usage" Data="cpuData" Unit="%" />
    <AverageUsageDisplay Label="Average Memory Usage" Data="memoryData" Unit="%" />
    <AverageUsageDisplay Label="Average GPU Usage" Data="gpuData" Unit="%" />
</MudContainer>

<MudGrid Class="mt-2" Gutter="true" Style="height: 100vh; padding: 0;">
    <!-- CPU Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="cpuUsageChart" Title="CPU Usage" Data="cpuData" Options="CpuChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Memory Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="memoryUsageChart" Title="Memory Usage" Data="memoryData" Options="MemoryChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- GPU Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="gpuUsageChart" Title="GPU Usage" Data="gpuData" Options="GpuChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Download Speed Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="downloadChart" Title="Download Speed" Data="downloadData" Options="DownloadChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Upload Speed Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="uploadChart" Title="Upload Speed" Data="uploadData" Options="UploadChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Battery Level Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="batteryUsageChart" Title="Battery Level" Data="batteryData" Options="BatteryChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- Storage Usage Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="storageUsageChart" Title="Storage Usage" Data="storageData" Options="StorageChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>

    <!-- PSU Usage Chart -->
    <MudItem xs="12" md="4">
        <MudCard Elevation="6" Style="height: 100%; padding: 16px; margin-bottom: 16px;">
            <MudCardContent>
                <UsageChart @ref="psuUsageChart" Title="PSU Usage" Data="psuData" Options="PsuChartOptions" />
            </MudCardContent>
        </MudCard>
    </MudItem>
</MudGrid>